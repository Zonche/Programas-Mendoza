REM ESTA ES LA RUTINA DE RELLENADO AVANZADA
REM NECESITA CONOCER LOS TAMA¥OS MAXIMOS DE LA PANTALLA REAL (XMAX E YMAX)

REM INICIALIZAMOS LAS VARIABLES AL PRINCIPIO

DIM MAX(YMAX)
DIM MIN(YMAX)

REM ANTES DE TRAZAR NINGUN POLIGONO INICIALIZAMOS LAS VARIABLES

FOR N = 0 TO YMAX
        MIN(N) = XMAX
        MAX(N) = 0
NEXT N
YMINI = YMAX
YMAXI = 0

REM TRAZAMOS TODAS LAS LINEAS DEL POLIGONO

TRAZAR:

DX = XF - XI
DY = YF - YI
IF DX <> 0 OR DY <> 0 THEN
       
        REM MULTIPLICO DX O DY POR 1.1 PARA QUE COJA MAS PUNTOS DE LOS
        REM NECESARIOS, Y EVITAR ASI ERRORES DE REDONDEO, QUE DARIAN LUGAR
        REM A LINEAS EN BLANCO EN MEDIO DE LA FIGURA.
       
        IF ABS(DX) > ABS(DY) THEN
                PASO# = 1 / (1.1 * DX)
        ELSE
                PASO# = 1 / (1.1 * DY)
        END IF
ELSE
        PASO# = 1
END IF
FOR CU# = 0 TO 1 STEP ABS(PASO#)
        X = INT(XI + CU# * DX)
        Y = INT(YI + CU# * DY)
        IF X >= 0 AND X < XMAX AND Y >= 0 AND Y < YMAX THEN
               
                REM ESTA INSTRUCCION PSET SE PUEDE ELIMINAR
                REM PUES EL ALGORITMO NO SE BASA EN LA IMAGEN DE PANTALLA
               
                PSET (X, Y)
                IF X > MAX(Y) THEN MAX(Y) = X
                IF X < MIN(Y) THEN MIN(Y) = X
                IF Y < YMINI THEN YMINI = Y
                IF Y > YMAXI THEN YMAXI = Y
        END IF
NEXT CU#
RETURN


REM Y RELLENAMOS

RELLENAR:

FOR Y = YMINI TO YMAXI
        X0 = MIN(Y)
        X1 = MAX(Y)
        IF X0 <= X1 THEN LINE (X0, Y)-(X1, Y)
NEXT Y
RETURN

